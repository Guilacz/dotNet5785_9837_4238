<Window x:Class="PL.Call.CallListWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
        xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
        xmlns:local="clr-namespace:PL"
        mc:Ignorable="d"
        Title="CallListWindow" Height="450" Width="800"
        DataContext="{Binding RelativeSource={RelativeSource Mode=Self}}">

    <Window.Resources>
        <local:ConverterAddUpdate x:Key="ConverterAddUpdateKey"/>
        <BooleanToVisibilityConverter x:Key="BoolToVisibilityConverter"/>

    </Window.Resources>


    <!--External Grid-->
    <Grid Background="#F5F5DC">
        <Grid.ColumnDefinitions>
            <ColumnDefinition Width="0*"/>
            <ColumnDefinition/>
        </Grid.ColumnDefinitions>

        <!--Call List Lines-->
        <Grid.RowDefinitions>
            <RowDefinition Height="40*"/>
            <RowDefinition Height="500*"/>
            <RowDefinition Height="Auto"/>
        </Grid.RowDefinitions>



        <Grid Height="auto" Grid.Row="0" Width="auto" Grid.ColumnSpan="7">
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="*" />
                <ColumnDefinition Width="2*" />
                <ColumnDefinition Width="*" />
                <ColumnDefinition Width="2*" />
                <ColumnDefinition Width="*" />
                <ColumnDefinition Width="2*" />
                <ColumnDefinition Width="2*" />
            </Grid.ColumnDefinitions>

      

            <!-- Label for "Sort By" -->
            <Label Grid.Column="0" Content="מיון לפי:" HorizontalAlignment="Right" VerticalAlignment="Center" />

            <!-- ComboBox for Sorting -->
            <ComboBox 
            Grid.Column="1" 
            HorizontalAlignment="Left" 
            VerticalAlignment="Center" 
            Width="150"
            SelectedItem="{Binding SelectedSortBy, Mode=TwoWay}" 
            ItemsSource="{Binding SortByOptions}" />

            <!-- Label for "Filter By" -->
            <Label Grid.Column="2" Content="סינון לפי:" HorizontalAlignment="Right" VerticalAlignment="Center" />

            <!-- ComboBox for Filtering -->
            <ComboBox 
            Grid.Column="3" 
            HorizontalAlignment="Left" 
            VerticalAlignment="Center" 
            Width="150"
            SelectedItem="{Binding SelectedFilterBy, Mode=TwoWay}"
            ItemsSource="{Binding FilterByOptions}" />

            <!-- Label for "Filter Value" -->
            <Label Grid.Column="4" Content="ערך לסינון:" HorizontalAlignment="Right" VerticalAlignment="Center" />

            <!-- ComboBox for Filter Values -->
            <ComboBox 
            Grid.Column="5" 
            HorizontalAlignment="Left" 
            VerticalAlignment="Center" 
            Width="150"
            ItemsSource="{Binding FilterValueOptions}" 
            SelectedItem="{Binding SelectedFilterValue, Mode=TwoWay}" />
        </Grid>


        <!--datagrid of the list of the calls-->
        <DataGrid  ItemsSource="{Binding CallList, RelativeSource={RelativeSource AncestorType=Window}}" 
          SelectedItem="{Binding SelectedCall, RelativeSource={RelativeSource AncestorType=Window}}" 
          AutoGenerateColumns="False" IsReadOnly="True" EnableRowVirtualization="True"
          RowDetailsVisibilityMode="VisibleWhenSelected" Grid.ColumnSpan="2" Margin="0,28,0,0" Grid.RowSpan="2" MouseDoubleClick="DataGrid_MouseDoubleClick">
            <DataGrid.Columns>
                <DataGridTextColumn Binding="{Binding CallId}" Header="Id of the call" Width="Auto"/>

                <!-- Column for CallType -->
                <DataGridTextColumn Binding="{Binding CallType}" Header=" Type of the call" Width="Auto"/>

                <!-- Column for CallStatus -->
                <DataGridTextColumn Binding="{Binding CallInListStatus}" Header="Status of the call" Width="Auto"/>

                <!-- Column for OpenTime -->
                <DataGridTextColumn Binding="{Binding OpenTime}" Header="Opening time" Width="Auto"/>

                <!-- Column for TimeToEnd -->
                <DataGridTextColumn Binding="{Binding TimeToEnd}" Header="Remaining time" Width="Auto"/>

                <!-- Column for LastName -->
                <DataGridTextColumn Binding="{Binding LastName}" Header="Name of the last volunteer" Width="Auto"/>

                <!-- Column for TimeToCare -->
                <DataGridTextColumn Binding="{Binding TimeToCare}" Header="Time to care" Width="Auto"/>

                <!-- Column for sum of assignments -->
                <DataGridTextColumn Binding="{Binding NumberOfAssignment}" Header="Total of assignements" Width="Auto"/>
                
                
                <!--delete buttun-->
                <DataGridTemplateColumn Header="Actions">
                    <DataGridTemplateColumn.CellTemplate>
                        <DataTemplate>
                            <Button Content="Delete" 
        Click="DeleteButton_Click" 
        Tag="{Binding CallId}" 
        Visibility="{Binding  ., Converter={StaticResource ConverterAddUpdateKey}, ConverterParameter=Delete}"/>

                        </DataTemplate>
                    </DataGridTemplateColumn.CellTemplate>
                </DataGridTemplateColumn>


            </DataGrid.Columns>



        </DataGrid>

        <Button Content="Add" Grid.Row="1" HorizontalAlignment="Center" Height="50" Width="100" Click="AddButton_Click" Grid.Column="1" Margin="0,490,0,0" Grid.RowSpan="2"/>





    </Grid>
</Window>
